"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var express = require("express");
var bodyParser = require("body-parser");
var expressValidator = require("express-validator");
var path = require("path");
var routes_1 = require("./config/routes/routes");
var util_1 = require("./util");
var controllers_1 = require("./controllers");
var util_2 = require("./util");
var env = process.env.NODE_ENV || 'development';
var config = require(path.join(__dirname, 'config', 'json-config', 'server.config.json'))[env];
var debug = require('debug')('server');
var app = express();
exports.app = app;
// all middleware
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
// khai báo express-validator middleware
app.use(expressValidator(util_1.options));
// security middleware
// app.all('/api/*', new ValidateRequest().validate);
//allow CORS
app.use(function (req, res, next) {
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
    next();
});
// middleware for validator
// TODO fix sau :)))
app.set('port', 3100);
// all static resource
app.use('/app', express.static(path.resolve(__dirname, '../client/app')));
app.use('/libs', express.static(path.resolve(__dirname, '../client/libs')));
app.use('/css', express.static(path.resolve(__dirname, '../client/css')));
app.use('/assets', express.static(path.resolve(__dirname, '../client/assets')));
app.use('/scripts', express.static(path.resolve(__dirname, '../client/scripts')));
// for system.js to work. Can be removed if bundling.
app.use(express.static(path.resolve(__dirname, '../client')));
app.use(express.static(path.resolve(__dirname, '../../node_modules')));
app.use('/login', new controllers_1.AuthController().login);
app.use('/api', new routes_1.default().routes);
// router để test cái test
app.get('/user', function (req, res) {
    res.status(200).json({ name: 'duc' });
});
app.post('/user', function (req, res) {
    var value = req.body;
    res.status(200).json(value);
});
app.post('/userName', function (req, res) {
    res.status(200).send(req.query.name);
});
//-----end router test------------------------------
var renderIndex = function (req, res) {
    res.sendFile(path.resolve(__dirname, '../client/index.html'));
};
app.get('/*', renderIndex);
if (env === 'developement' || env === 'developement') {
    app.use(function (err, req, res, next) {
        res.status(err.status || 500);
        res.json({
            error: err,
            message: err.message
        });
    });
}
// catch 404 and forward to error handler
app.use(function (req, res, next) {
    var err = new Error("Not Found");
    err['status'] = 404;
    next(err);
});
// production error handler
// no stacktrace leaked to user
app.use(function (err, req, res, next) {
    res.status(err.status || 500);
    res.json({
        error: {},
        message: err.message
    });
});
process.on('uncaughtException', function (err) {
    debug('uncaughtException: %s', err);
    util_2.LogUtil.error('uncaughtException', err);
});
process.on('unhandledRejection', function (reason, p) {
    debug('Unhandled Rejection at: Promise %s, reason: %s', p, reason);
    util_2.LogUtil.error('Unhandled Rejection', reason, p);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlDQUFvQztBQUNwQyx3Q0FBMkM7QUFDM0Msb0RBQXVEO0FBQ3ZELDJCQUE4QjtBQUU5QixpREFBZ0Q7QUFDaEQsK0JBQWlDO0FBRWpDLDZDQUErQztBQUMvQywrQkFBaUM7QUFFakMsSUFBSSxHQUFHLEdBQVcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLElBQUksYUFBYSxDQUFDO0FBQ3hELElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMvRixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7QUFJdkMsSUFBSSxHQUFHLEdBQUcsT0FBTyxFQUFFLENBQUM7QUFnR1gsa0JBQUc7QUE5RlosaUJBQWlCO0FBQ2pCLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7QUFDM0IsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztBQUNuRCx3Q0FBd0M7QUFDeEMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ25DLHNCQUFzQjtBQUN0QixxREFBcUQ7QUFFckQsWUFBWTtBQUNaLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUk7SUFDNUIsR0FBRyxDQUFDLE1BQU0sQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUMvQyxHQUFHLENBQUMsTUFBTSxDQUFDLDhCQUE4QixFQUFFLGdEQUFnRCxDQUFDLENBQUM7SUFDN0YsSUFBSSxFQUFFLENBQUM7QUFDWCxDQUFDLENBQUMsQ0FBQztBQUVILDJCQUEyQjtBQUMzQixHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7QUFFN0Isc0JBQXNCO0FBQ3RCLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDNUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoRixHQUFHLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBRWxGLHFEQUFxRDtBQUNyRCxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzlELEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUV2RSxHQUFHLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxJQUFJLDRCQUFjLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUM5QyxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxJQUFJLGdCQUFVLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUl6QywwQkFBMEI7QUFDMUIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsVUFBQyxHQUFHLEVBQUUsR0FBRztJQUN0QixHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQzFDLENBQUMsQ0FBQyxDQUFDO0FBRUgsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsVUFBQyxHQUFHLEVBQUUsR0FBRztJQUN2QixJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDO0lBQ3JCLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2hDLENBQUMsQ0FBQyxDQUFDO0FBRUgsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsVUFBQyxHQUFHLEVBQUUsR0FBRztJQUMzQixHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3pDLENBQUMsQ0FBQyxDQUFDO0FBQ0gsb0RBQW9EO0FBRXBELElBQUksV0FBVyxHQUFHLFVBQUMsR0FBb0IsRUFBRSxHQUFxQjtJQUMxRCxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLHNCQUFzQixDQUFDLENBQUMsQ0FBQztBQUNsRSxDQUFDLENBQUM7QUFFRixHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztBQUUzQixJQUFJLEdBQUcsS0FBSyxjQUFjLElBQUksR0FBRyxLQUFLLGNBQWMsRUFBRTtJQUNsRCxHQUFHLENBQUMsR0FBRyxDQUFDLFVBQVUsR0FBRyxFQUFFLEdBQW9CLEVBQUUsR0FBcUIsRUFBRSxJQUEwQjtRQUMxRixHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLElBQUksR0FBRyxDQUFDLENBQUM7UUFDOUIsR0FBRyxDQUFDLElBQUksQ0FBQztZQUNMLEtBQUssRUFBRSxHQUFHO1lBQ1YsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPO1NBQ3ZCLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0NBQ047QUFHRCx5Q0FBeUM7QUFDekMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEdBQW9CLEVBQUUsR0FBcUIsRUFBRSxJQUFJO0lBQy9ELElBQUksR0FBRyxHQUFHLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2pDLEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDcEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ2QsQ0FBQyxDQUFDLENBQUM7QUFFSCwyQkFBMkI7QUFDM0IsK0JBQStCO0FBQy9CLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxHQUFRLEVBQUUsR0FBb0IsRUFBRSxHQUFxQixFQUFFLElBQTBCO0lBQy9GLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sSUFBSSxHQUFHLENBQUMsQ0FBQztJQUM5QixHQUFHLENBQUMsSUFBSSxDQUFDO1FBQ0wsS0FBSyxFQUFFLEVBQUU7UUFDVCxPQUFPLEVBQUUsR0FBRyxDQUFDLE9BQU87S0FDdkIsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUM7QUFFSCxPQUFPLENBQUMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLFVBQVUsR0FBRztJQUN6QyxLQUFLLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDcEMsY0FBTyxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUMsQ0FBQTtBQUVGLE9BQU8sQ0FBQyxFQUFFLENBQUMsb0JBQW9CLEVBQUUsVUFBQyxNQUFNLEVBQUUsQ0FBQztJQUN2QyxLQUFLLENBQUMsZ0RBQWdELEVBQUUsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ25FLGNBQU8sQ0FBQyxLQUFLLENBQUMscUJBQXFCLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3BELENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6InNlcnZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5pbXBvcnQgYm9keVBhcnNlciA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTtcclxuaW1wb3J0IGV4cHJlc3NWYWxpZGF0b3IgPSByZXF1aXJlKCdleHByZXNzLXZhbGlkYXRvcicpO1xyXG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuXHJcbmltcG9ydCBCYXNlUm91dGVzIGZyb20gJy4vY29uZmlnL3JvdXRlcy9yb3V0ZXMnO1xyXG5pbXBvcnQgeyBvcHRpb25zIH0gZnJvbSAnLi91dGlsJztcclxuaW1wb3J0IHsgQXV0aFZhbGlkYXRvciB9IGZyb20gJy4vbWlkZGxld2FyZSc7XHJcbmltcG9ydCB7IEF1dGhDb250cm9sbGVyIH0gZnJvbSAnLi9jb250cm9sbGVycyc7XHJcbmltcG9ydCB7IExvZ1V0aWwgfSBmcm9tICcuL3V0aWwnO1xyXG5cclxudmFyIGVudjogc3RyaW5nID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50JztcclxubGV0IGNvbmZpZyA9IHJlcXVpcmUocGF0aC5qb2luKF9fZGlybmFtZSwgJ2NvbmZpZycsICdqc29uLWNvbmZpZycsICdzZXJ2ZXIuY29uZmlnLmpzb24nKSlbZW52XTtcclxubGV0IGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnc2VydmVyJyk7XHJcblxyXG5cclxuXHJcbnZhciBhcHAgPSBleHByZXNzKCk7XHJcblxyXG4vLyBhbGwgbWlkZGxld2FyZVxyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbi8vIGtoYWkgYsOhbyBleHByZXNzLXZhbGlkYXRvciBtaWRkbGV3YXJlXHJcbmFwcC51c2UoZXhwcmVzc1ZhbGlkYXRvcihvcHRpb25zKSk7XHJcbi8vIHNlY3VyaXR5IG1pZGRsZXdhcmVcclxuLy8gYXBwLmFsbCgnL2FwaS8qJywgbmV3IFZhbGlkYXRlUmVxdWVzdCgpLnZhbGlkYXRlKTtcclxuXHJcbi8vYWxsb3cgQ09SU1xyXG5hcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xyXG4gICAgcmVzLmhlYWRlcihcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiLCBcIipcIik7XHJcbiAgICByZXMuaGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiLCBcIk9yaWdpbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgQ29udGVudC1UeXBlLCBBY2NlcHRcIik7XHJcbiAgICBuZXh0KCk7XHJcbn0pO1xyXG5cclxuLy8gbWlkZGxld2FyZSBmb3IgdmFsaWRhdG9yXHJcbmFwcC5zZXQoJ3BvcnQnLCBjb25maWcucG9ydCk7XHJcblxyXG4vLyBhbGwgc3RhdGljIHJlc291cmNlXHJcbmFwcC51c2UoJy9hcHAnLCBleHByZXNzLnN0YXRpYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vY2xpZW50L2FwcCcpKSk7XHJcbmFwcC51c2UoJy9saWJzJywgZXhwcmVzcy5zdGF0aWMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uL2NsaWVudC9saWJzJykpKTtcclxuYXBwLnVzZSgnL2NzcycsIGV4cHJlc3Muc3RhdGljKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLi9jbGllbnQvY3NzJykpKTtcclxuYXBwLnVzZSgnL2Fzc2V0cycsIGV4cHJlc3Muc3RhdGljKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLi9jbGllbnQvYXNzZXRzJykpKTtcclxuYXBwLnVzZSgnL3NjcmlwdHMnLCBleHByZXNzLnN0YXRpYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vY2xpZW50L3NjcmlwdHMnKSkpO1xyXG5cclxuLy8gZm9yIHN5c3RlbS5qcyB0byB3b3JrLiBDYW4gYmUgcmVtb3ZlZCBpZiBidW5kbGluZy5cclxuYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vY2xpZW50JykpKTtcclxuYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vLi4vbm9kZV9tb2R1bGVzJykpKTtcclxuXHJcbmFwcC51c2UoJy9sb2dpbicsIG5ldyBBdXRoQ29udHJvbGxlcigpLmxvZ2luKTtcclxuYXBwLnVzZSgnL2FwaScsIG5ldyBCYXNlUm91dGVzKCkucm91dGVzKTtcclxuXHJcblxyXG5cclxuLy8gcm91dGVyIMSR4buDIHRlc3QgY8OhaSB0ZXN0XHJcbmFwcC5nZXQoJy91c2VyJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG5hbWU6ICdkdWMnIH0pO1xyXG59KTtcclxuXHJcbmFwcC5wb3N0KCcvdXNlcicsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgbGV0IHZhbHVlID0gcmVxLmJvZHk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih2YWx1ZSk7XHJcbn0pO1xyXG5cclxuYXBwLnBvc3QoJy91c2VyTmFtZScsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgcmVzLnN0YXR1cygyMDApLnNlbmQocmVxLnF1ZXJ5Lm5hbWUpO1xyXG59KTtcclxuLy8tLS0tLWVuZCByb3V0ZXIgdGVzdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxudmFyIHJlbmRlckluZGV4ID0gKHJlcTogZXhwcmVzcy5SZXF1ZXN0LCByZXM6IGV4cHJlc3MuUmVzcG9uc2UpID0+IHtcclxuICAgIHJlcy5zZW5kRmlsZShwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4vY2xpZW50L2luZGV4Lmh0bWwnKSk7XHJcbn07XHJcblxyXG5hcHAuZ2V0KCcvKicsIHJlbmRlckluZGV4KTtcclxuXHJcbmlmIChlbnYgPT09ICdkZXZlbG9wZW1lbnQnIHx8IGVudiA9PT0gJ2RldmVsb3BlbWVudCcpIHtcclxuICAgIGFwcC51c2UoZnVuY3Rpb24gKGVyciwgcmVxOiBleHByZXNzLlJlcXVlc3QsIHJlczogZXhwcmVzcy5SZXNwb25zZSwgbmV4dDogZXhwcmVzcy5OZXh0RnVuY3Rpb24pIHtcclxuICAgICAgICByZXMuc3RhdHVzKGVyci5zdGF0dXMgfHwgNTAwKTtcclxuICAgICAgICByZXMuanNvbih7XHJcbiAgICAgICAgICAgIGVycm9yOiBlcnIsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbi8vIGNhdGNoIDQwNCBhbmQgZm9yd2FyZCB0byBlcnJvciBoYW5kbGVyXHJcbmFwcC51c2UoZnVuY3Rpb24gKHJlcTogZXhwcmVzcy5SZXF1ZXN0LCByZXM6IGV4cHJlc3MuUmVzcG9uc2UsIG5leHQpIHtcclxuICAgIGxldCBlcnIgPSBuZXcgRXJyb3IoXCJOb3QgRm91bmRcIik7XHJcbiAgICBlcnJbJ3N0YXR1cyddID0gNDA0O1xyXG4gICAgbmV4dChlcnIpO1xyXG59KTtcclxuXHJcbi8vIHByb2R1Y3Rpb24gZXJyb3IgaGFuZGxlclxyXG4vLyBubyBzdGFja3RyYWNlIGxlYWtlZCB0byB1c2VyXHJcbmFwcC51c2UoZnVuY3Rpb24gKGVycjogYW55LCByZXE6IGV4cHJlc3MuUmVxdWVzdCwgcmVzOiBleHByZXNzLlJlc3BvbnNlLCBuZXh0OiBleHByZXNzLk5leHRGdW5jdGlvbikge1xyXG4gICAgcmVzLnN0YXR1cyhlcnIuc3RhdHVzIHx8IDUwMCk7XHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgICAgZXJyb3I6IHt9LFxyXG4gICAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlXHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5wcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgIGRlYnVnKCd1bmNhdWdodEV4Y2VwdGlvbjogJXMnLCBlcnIpO1xyXG4gICAgTG9nVXRpbC5lcnJvcigndW5jYXVnaHRFeGNlcHRpb24nLCBlcnIpO1xyXG59KVxyXG5cclxucHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKHJlYXNvbiwgcCkgPT4ge1xyXG4gICAgZGVidWcoJ1VuaGFuZGxlZCBSZWplY3Rpb24gYXQ6IFByb21pc2UgJXMsIHJlYXNvbjogJXMnLCBwLCByZWFzb24pO1xyXG4gICAgTG9nVXRpbC5lcnJvcignVW5oYW5kbGVkIFJlamVjdGlvbicsIHJlYXNvbiwgcCk7XHJcbn0pO1xyXG5cclxuXHJcbmV4cG9ydCB7IGFwcCB9XHJcbiJdfQ==
